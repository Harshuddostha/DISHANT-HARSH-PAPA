<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DISHANT AI V2</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #f5f5f5;
            margin: 0;
            padding: 20px;
            text-align: center;
        }

        #mainApp {
            max-width: 500px;
            margin: auto;
            background: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4);
            border: 1px solid #0f0;
        }

        h1 {
            color: #0f0;
        }

        .card {
            background: #222;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #0f0;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .history-table th, .history-table td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #0f0;
        }
    </style>
</head>
<body>
    <div id="mainApp">
        <h1>DISHANT AI</h1>

        <div class="card">
            <h2>ðŸ§  AI Prediction: <span id="prediction">-</span></h2>
            <h2>ðŸ“… Current Period: <span id="currentPeriod">-</span></h2>
        </div>

        <div class="card">
            <h2>History (Last 10 Results)</h2>
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Period</th>
                        <th>Result</th>
                        <th>Big/Small</th>
                    </tr>
                </thead>
                <tbody id="historyTable"></tbody>
            </table>
        </div>
    </div>

    <script>
        let lastResults = [];

        async function fetchGameResults() {
            try {
                let response = await fetch("https://api.bdg88zf.com/api/webapi/GetNoaverageEmerdList", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        pageSize: 10,  // Fetch last 10 results
                        pageNo: 1,
                        typeId: 1,
                        language: 0,
                        random: "4a0522c6ecd8410496260e686be2a57c",
                        signature: "334B5E70A0C9B8918B0B15E517E2069C",
                        timestamp: Math.floor(Date.now() / 1000)
                    })
                });

                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                let data = await response.json();
                let results = data?.data?.list || [];

                return results.map(item => ({
                    period: parseInt(item.issueNumber),  // Ensure period is a number
                    result: item.number,
                    bigSmall: item.number >= 5 ? "BIG" : "SMALL"
                }));
            } catch (error) {
                console.error("Error fetching game results:", error);
                return [];
            }
        }

        function analyzeTrend(results) {
            let last5 = results.slice(0, 5); // Analyze only the last 5 results
            let bigCount = last5.filter(item => item.result >= 5).length;
            let smallCount = last5.filter(item => item.result < 5).length;
            return bigCount > smallCount ? "BIG" : "SMALL";
        }

        async function updateGameData() {
            lastResults = await fetchGameResults();
            if (lastResults.length === 0) return;

            let latestPeriod = lastResults[0].period + 1; // Increment latest period
            let prediction = analyzeTrend(lastResults);

            document.getElementById("currentPeriod").innerText = latestPeriod;
            document.getElementById("prediction").innerText = prediction;

            updateHistory();
        }

        function updateHistory() {
            let historyTable = document.getElementById("historyTable");
            historyTable.innerHTML = "";
            lastResults.forEach(item => {
                historyTable.innerHTML += `
                    <tr>
                        <td>${item.period}</td>
                        <td>${item.result}</td>
                        <td>${item.bigSmall}</td>
                    </tr>
                `;
            });
        }

        setInterval(updateGameData, 1000);
    </script>
</body>
</html>